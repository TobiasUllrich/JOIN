<!DOCTYPE html>
<html lang="en">

<head>
    <!-- KOPFBEREICH STANDARD-->


    <meta charset='UTF-8'> <!-- UTF-8 ist Standard, Alternativen: "ASCII" oder "ISO-8859-15" -->
    <meta http-equiv="X-UA-Compatible" content='IE=edge'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Sorgt für Barrierefreiheit -->

    <title>JOIN</title>
    <!--See Trello, Jira or kanbanflow-->
    <!--ToDos, In Progress, Backlog, Testing-->
    <!--Help-Sektion: Beschreibung wie es geht-->
    <!--Impressum & Datenschutz unten links in grau-->
    <!--Daten sollen auf Server mit smallest-backend-ever gespeichert werden-->
    <!--Learnings von Kochwelt-->

    <!-- Bootstrap CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <!-- Bootstrap CSS only -->

    <link href="img/logo.png" type="image/x-icon" rel="icon" /> <!-- Bindet FavIcon ein-->

    <!-- Fonts downloaden in entsprechenden Ordner legen und über Extra-CSS-Datei einbinden (https://google-webfonts-helper.herokuapp.com/) -->
    <link rel="stylesheet" type='text/css' media='screen' href="fonts.css">
    <script src="script.js"></script> <!-- Statt <script> ... </script> -->
    <link rel="stylesheet" type='text/css' media='screen' href="style.css"> <!-- Statt <style> ... </style> -->

    <!-- JavaScript Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>
    <!-- JavaScript Bootstrap -->

    <script src="mini_backend.js"></script> <!-- Zuerst einbinden, weil Funktion setURL verfügbar sein muss -->
    <script>
        // https://github.com/JunusErgin/smallest_backend_ever
        let users = [];
        let tasks = [];

        // Funktion setURL() ändert die Variable BASE_SERVER_URL auf den angegebenen Pfad
        // Unter dem angegebenen Pfad muss der Ordner smallest_backend_ever mit allen Dateien von GitHub liegen
        setURL('https://gruppe-2970.developerakademie.net/smallest_backend_ever');

        // WICHTIG ZU INSTALLIEREN SIND DIE FOLGENDEN ZWEI:
        //  FÜR CHROME-ERWEITERUNG: https://chrome.google.com/webstore/detail/allow-cors-access-control/lhobafahddgcelffkeicbaginigeejlf
        //  FÜR LIVE-SERVER: https://marketplace.visualstudio.com/items?itemName=ritwickdey.LiveServer


        async function init() {

            // GET User-Data form the Server which is saved in backend
            await downloadFromServer();
            users = JSON.parse(backend.getItem('users')) || [];

            // GET Tasks-Data form the Server which is saved in backendTWO
            await downloadFromServerTWO(); /** INSERT FOR SECOND JSON-FILE */
            tasks = JSON.parse(backendTWO.getItem('tasks')) || [];

        }

        // ADD USER TO ARRAY
        async function addUser(object) {
            users.push(object);
            //-> Im Live Array können wir gleich sehen, dass das Element inzugefügt wurde, es wird in der nächsten Zeile noch ins Backend übertragen
            await backend.setItem('users', JSON.stringify(users));
        }

        // ADD TASK TO ARRAY
        async function addTask(object) {
            tasks.push(object);
            console.log(tasks);
            //-> Im Live Array können wir gleich sehen, dass das Element inzugefügt wurde, es wird in der nächsten Zeile noch ins Backend übertragen
            await backendTWO.setItem('tasks', JSON.stringify(tasks));
        }

        // DELETE SPECIFIC USER FROM ARRAY
        async function delUser(index) {
            //let id = users.indexOf(name);
            if (index !== parseInt(index, 10))
              {console.log("Data is not an integer!");}
            if (index >= users.length || index < 0)
              {console.log("ERROR: Number to High or to Low!");}
            else if (index == 0 && users.length == 1)
              {console.log("KILL Complete Array");deleteAllUsers();}
            else 
            {
                console.log("Data is an integer!");
                users.splice(index, 1);
                //-> Im Live Array können wir gleich sehen, dass das Element gelöscht wurde, es wird in der nächsten Zeile noch ins Backend übertragen
                await backend.setItem('users', JSON.stringify(users));
            }
        }

        // DELETE SPECIFIC TASK FROM ARRAY
        async function delTask(index) {
            //let id = tasks.indexOf(name);
            if (index !== parseInt(index, 10))
              {console.log("Data is not an integer!");}
            if (index >= tasks.length || index < 0)
              {console.log("ERROR: Number to High or to Low!");}
            else if (index == 0 && tasks.length == 1)
              {console.log("KILL Complete Array");deleteAllTasks();}
            else 
            {
                console.log("Data is an integer!");
                tasks.splice(index, 1);
                //-> Im Live Array können wir gleich sehen, dass das Element gelöscht wurde, es wird in der nächsten Zeile noch ins Backend übertragen
                await backendTWO.setItem('tasks', JSON.stringify(tasks));
            }
        }


        // DELETE ALL USERS FROM ARRAY
        async function deleteAllUsers() {
            await backend.deleteItem('users');
            //-> Wenn jetzt nach dem Deleten ein init() ausgeführt wird, dann sieht man, dass das Array leer ist
        }


        // DELETE ALL TASKS FROM ARRAY
        async function deleteAllTasks() {
            await backendTWO.deleteItem('tasks');
            //-> Wenn jetzt nach dem Deleten ein init() ausgeführt wird, dann sieht man, dass das Array leer ist
        }


    </script>



    <script src="board.js"></script> <!-- Statt <script> ... </script> -->
    <script src="backlog.js"></script> <!-- Statt <script> ... </script> -->
    <script src="addTask.js"></script> <!-- Statt <script> ... </script> -->


    <!-- KOPFBEREICH STANDARD-->
</head>


<!--Sobald der body-Bereich geladen wurde, wird das Java-Script ausgeführt-->

<body onload="includeHTML();init();">


    <!-- Header einbinden -->
    <div w3-include-html="templates/header.html"></div>
    <!-- Header einbinden -->


    <!-- MAIN -->
    <div style="margin-left:120px;">
        <h1>So sieht die eingebundene Schrift aus</h1>
    </div>
    <!-- MAIN -->


    <!-- Footer einbinden -->
    <div w3-include-html="templates/footer.html"></div>
    <!-- Footer einbinden -->


</body>



</html>